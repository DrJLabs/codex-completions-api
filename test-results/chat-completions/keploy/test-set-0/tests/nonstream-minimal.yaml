version: api.keploy.io/v1beta1
kind: Http
name: nonstream-minimal
spec:
  metadata:
    description: Chat completions snapshot for nonstream-minimal
    codex_bin: scripts/fake-codex-proto.js
    commit: 4427422cbce0e5b29c8a60dd07264cdf53febbee
    include_usage: "false"
    placeholders: '{"id":"<dynamic-id>","created":"<timestamp>"}'
  req:
    method: POST
    proto_major: 1
    proto_minor: 1
    url: http://127.0.0.1:11436/v1/chat/completions
    header:
      Content-Type: application/json
      Authorization: Bearer test-sk-ci
    body: |-
      {
        "model": "codex-5",
        "stream": false,
        "messages": [
          {
            "role": "user",
            "content": "Hello transcript"
          }
        ]
      }
    timestamp: 2025-09-20T22:46:34.539Z
  resp:
    status_code: 200
    header:
      Content-Type: application/json; charset=utf-8
    body: |-
      {
        "id": "<dynamic-id>",
        "object": "chat.completion",
        "created": "<timestamp>",
        "model": "codex-5",
        "choices": [
          {
            "index": 0,
            "message": {
              "role": "assistant",
              "content": "Hello from fake-codex."
            },
            "finish_reason": "stop"
          }
        ],
        "usage": {
          "prompt_tokens": 8,
          "completion_tokens": 6,
          "total_tokens": 14
        }
      }
    proto_major: 1
    proto_minor: 1
    timestamp: 2025-09-20T22:46:34.539Z
  objects: []
  assertions:
    noise:
      body:
        - $.id
        - $.created
  created: 1758408394
