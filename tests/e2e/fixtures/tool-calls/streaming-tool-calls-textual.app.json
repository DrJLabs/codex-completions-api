{
  "metadata": {
    "codex_bin": "scripts/fake-codex-jsonrpc.js",
    "cli_version": "0.58.0",
    "node_version": "v24.11.0",
    "backend": "app-server",
    "backend_storage": "app",
    "expected_status": 200,
    "captured_at": "2025-11-22T04:43:44.804Z",
    "include_usage": false,
    "commit": "e8300ed0086bdf9503d67e56f48bd299be184aa8",
    "env": {
      "FAKE_CODEX_MODE": "textual_tool"
    },
    "scenario": "textual-tool-fallback",
    "abort_after_first_tool": false
  },
  "request": {
    "model": "codex-5",
    "stream": true,
    "messages": [
      {
        "role": "user",
        "content": "Demonstrate textual <use_tool> fallback with multibyte payload."
      }
    ],
    "tools": [],
    "tool_choice": "none"
  },
  "stream": [
    {
      "type": "data",
      "data": {
        "id": "<dynamic-id>",
        "object": "chat.completion.chunk",
        "created": "<timestamp>",
        "model": "codex-5",
        "choices": [
          {
            "index": 0,
            "delta": {
              "role": "assistant"
            },
            "finish_reason": null
          }
        ],
        "usage": null
      }
    },
    {
      "type": "data",
      "data": {
        "id": "<dynamic-id>",
        "object": "chat.completion.chunk",
        "created": "<timestamp>",
        "model": "codex-5",
        "choices": [
          {
            "index": 0,
            "delta": {
              "tool_calls": [
                {
                  "index": 0,
                  "id": "tool_0_0",
                  "type": "function",
                  "function": {
                    "name": "lookup_user",
                    "arguments": "{\"id\": \"ユーザー-12345\"}"
                  }
                }
              ]
            },
            "finish_reason": null
          }
        ],
        "usage": null
      }
    },
    {
      "type": "data",
      "data": {
        "id": "<dynamic-id>",
        "object": "chat.completion.chunk",
        "created": "<timestamp>",
        "model": "codex-5",
        "choices": [
          {
            "index": 0,
            "delta": {
              "content": "<use_tool>\n  <name>lookup_user</name>\n  <id>ユーザー-12345</id>\n</use_tool>"
            },
            "finish_reason": null
          }
        ],
        "usage": null
      }
    },
    {
      "type": "data",
      "data": {
        "id": "<dynamic-id>",
        "object": "chat.completion.chunk",
        "created": "<timestamp>",
        "model": "codex-5",
        "choices": [
          {
            "index": 0,
            "delta": {},
            "finish_reason": "tool_calls"
          }
        ],
        "usage": null
      }
    },
    {
      "type": "comment",
      "comment": "{\"tool_call_count\":1,\"tool_call_truncated\":false,\"stop_after_tools_mode\":\"burst\"}"
    },
    {
      "type": "done"
    }
  ]
}
